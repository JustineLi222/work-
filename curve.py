from scipy.optimize import curve_fit
import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import find_peaks

a=-0.25447945234707087
b=4168.18673289118
def model_f(x, a, b):
    return a*x+b


y_data=np.array([4165 ,4168 ,4167 ,4168 ,4168 ,4167 ,4168 ,4167 ,4166 ,4167 
                 ,4166 ,4165 ,4166 ,4166 ,4165 ,4167 ,4165 ,4165 ,4166 ,4166 
                 ,4164 ,4164 ,4163 ,4161 ,4163 ,4163 ,4162 ,4160 ,4159 ,4160 ,4160 ,4161 ,4160 ,4160 ,4159 ,4160 ,4159 ,4159 ,4159 ,4158 ,4157 ,4158 ,4157 ,4157 ,4157 ,4154 ,4155 ,4155 ,4154 ,4154 ,4153 ,4155 ,4154 ,4154 ,4154 ,4153 ,4154 ,4153 ,4151 ,4152 ,4152 ,4150 ,4150 ,4150 ,4150 ,4151 ,4151 ,4150 ,4149 ,4151 ,4150 ,4149 ,4150 ,4149 ,4151 ,4151 ,4154 ,4152 ,4152 ,4152 ,4151 ,4149 ,4149 ,4147 ,4147 ,4147 ,4145 ,4146 ,4144 ,4144 ,4144 ,4145 ,4145 ,4143 ,4144 ,4143 ,4145 ,4145 ,4146 ,4143 ,4144 ,4143 ,4145 ,4145 ,4146 ,4147 ,4147 ,4147 ,4146 ,4147 ,4148 ,4148 ,4149 ,4148 ,4150 ,4151 ,4150 ,4151 ,4152 ,4152 ,4152 ,4152 ,4151 ,4151 ,4151 ,4152 ,4151 ,4152 ,4154 ,4154 ,4154 ,4154 ,4155 ,4155 ,4155 ,4156 ,4155 ,4157 ,4158 ,4157 ,4157 ,4156 ,4155 ,4157 ,4156 ,4154 ,4153 ,4154 ,4153 ,4152 ,4154 ,4154 ,4155 ,4156 ,4158 ,4158 ,4159 ,4159 ,4161 ,4162 ,4161 ,4161 ,4162 ,4162 ,4161 ,4160 ,4160 ,4158 ,4158 ,4157 ,4157 ,4156 ,4157 ,4156 ,4157 ,4156 ,4158 ,4158 ,4158 ,4157 ,4157 ,4157 ,4156 ,4156 ,4157 ,4154 ,4151 ,4152 ,4151 ,4149 ,4149 ,4147 ,4147 ,4145 ,4145 ,4144 ,4143 ,4142 ,4140 ,4141 ,4141 ,4140 ,4139 ,4139 ,4140 ,4140 ,4139 ,4138 ,4137 ,4135 ,4135 ,4135 ,4133 ,4134 ,4134 ,4133 ,4131 ,4133 ,4133 ,4133 ,4133 ,4133 ,4132 ,4132 ,4131 ,4131 ,4131 ,4131 ,4130 ,4131 ,4131 ,4132 ,4132 ,4131 ,4132 ,4132 ,4130 ,4131 ,4129 ,4129 ,4128 ,4128 ,4129 ,4128 ,4127 ,4128 ,4127 ,4128 ,4126 ,4126 ,4126 ,4127 ,4127 ,4128 ,4128 ,4129 ,4131 ,4131 ,4132 ,4133 ,4134 ,4135 ,4136 ,4138 ,4139 ,4141 ,4141 ,4142 ,4144 ,4144 ,4144 ,4143 ,4143 ,4144 ,4143 ,4144 ,4145 ,4146 ,4146 ,4148 ,4146 ,4146 ,4147 ,4145 ,4144 ,4143 ,4144 ,4143 ,4141 ,4140 ,4139 ,4138 ,4136 ,4135 ,4134 ,4132 ,4130 ,4131 ,4127 ,4126 ,4124 ,4123 ,4122 ,4121 ,4120 ,4119 ,4118 ,4116 ,4116 ,4116 ,4115 ,4116 ,4115 ,4116 ,4115 ,4114 ,4113 ,4112 ,4112 ,4112 ,4110 ,4109 ,4109 ,4108 ,4109 ,4107 ,4105 ,4107 ,4106 ,4106 ,4105 ,4105 ,4105 ,4104 ,4103 ,4103 ,4105 ,4105 ,4104 ,4105 ,4102 ,4102 ,4101 ,4101 ,4101 ,4100 ,4101 ,4100 ,4101 ,4100 ,4099 ,4100 ,4099 ,4098 ,4098 ,4099 ,4098 ,4097 ,4097 ,4096 ,4096 ,4095 ,4095 ,4095 ,4093 ,4094 ,4094 ,4094 ,4094 ,4095 ,4094 ,4095 ,4093 ,4093 ,4093 ,4094 ,4095 ,4093 ,4094 ,4094 ,4094 ,4095 ,4094 ,4094 ,4094 ,4094 ,4093 ,4094 ,4094 ,4093 ,4093 ,4094 ,4093 ,4094 ,4094 ,4094 ,4096 ,4095 ,4095 ,4095 ,4095 ,4095 ,4094 ,4095 ,4094 ,4094 ,4094 ,4094 ,4093 ,4094 ,4094 ,4093 ,4094 ,4094 ,4096 ,4095 ,4095 ,4098 ,4096 ,4097 ,4098 ,4096 ,4097 ,4097 ,4096 ,4096 ,4096 ,4094 ,4093 ,4094 ,4094 ,4093 ,4093 ,4093 ,4092 ,4094 ,4090 ,4091 ,4092 ,4091 ,4092 ,4093 ,4094 ,4094 ,4093 ,4093 ,4093 ,4092 ,4092 ,4090 ,4090 ,4089 ,4087 ,4088 ,4087 ,4086 ,4086 ,4085 ,4085 ,4084 ,4085 ,4083 ,4083 ,4081 ,4082 ,4080 ,4080 ,4081 ,4081 ,4082 ,4082 ,4082 ,4082 ,4083 ,4082 ,4082 ,4081 ,4080 ,4080 ,4079 ,4079 ,4079 ,4081 ,4083 ,4088 ,4096 ,4109 ,4125 ,4140 ,4162 ,4183 ,4206 ,4231 ,4253 ,4276 ,4298 ,4318 ,4339 ,4358 ,4376 ,4385 ,4399 ,4416 ,4431 ,4448 ,4465 ,4482 ,4496 ,4513 ,4525 ,4542 ,4556 ,4569 ,4582 ,4593 ,4609 ,4620 ,4630 ,4641 ,4652 ,4664 ,4674 ,4686 ,4695 ,4704 ,4718 ,4726 ,4736 ,4746 ,4757 ,4767 ,4777 ,4787 ,4796 ,4807 ,4812 ,4822 ,4827 ,4836 ,4843 ,4846 ,4848 ,4847 ,4843 ,4839 ,4834 ,4826 ,4817 ,4809 ,4801 ,4793 ,4784 ,4775 ,4766 ,4759 ,4749 ,4743 ,4736 ,4730 ,4725 ,4720 ,4713 ,4709 ,4704 ,4698 ,4692 ,4689 ,4685 ,4682 ,4676 ,4673 ,4669 ,4666 ,4662 ,4661 ,4655 ,4652 ,4651 ,4648 ,4645 ,4641 ,4639 ,4637 ,4634 ,4632 ,4631 ,4627 ,4626 ,4624 ,4622 ,4621 ,4619 ,4617 ,4614 ,4610 ,4609 ,4608 ,4607 ,4606 ,4603 ,4602 ,4600 ,4599 ,4599 ,4596 ,4593 ,4592 ,4589 ,4588 ,4587 ,4584 ,4583 ,4579 ,4579 ,4578 ,4575 ,4573 ,4570 ,4570 ,4569 ,4569 ,4566 ,4566 ,4564 ,4562 ,4561 ,4560 ,4559 ,4556 ,4556 ,4555 ,4553 ,4550 ,4548 ,4547 ,4547 ,4545 ,4542 ,4542 ,4540 ,4539 ,4536 ,4537 ,4535 ,4532 ,4530 ,4527 ,4525 ,4521 ,4520 ,4518 ,4515 ,4512 ,4508 ,4504 ,4503 ,4500 ,4497 ,4496 ,4497 ,4498 ,4499 ,4496 ,4497 ,4496 ,4498 ,4497 ,4496 ,4496 ,4495 ,4493 ,4492 ,4489 ,4484 ,4481 ,4478 ,4475 ,4473 ,4467 ,4462 ,4457 ,4450 ,4444 ,4440 ,4434 ,4429 ,4424 ,4419 ,4415 ,4409 ,4402 ,4398 ,4394 ,4389 ,4382 ,4378 ,4373 ,4368 ,4363 ,4361 ,4354 ,4350 ,4344 ,4339 ,4333 ,4328 ,4324 ,4319 ,4314 ,4308 ,4304 ,4299 ,4293 ,4289 ,4285 ,4280 ,4276 ,4273 ,4269 ,4265 ,4261 ,4258 ,4256 ,4252 ,4247 ,4245 ,4242 ,4238 ,4238 ,4235 ,4232 ,4228 ,4225 ,4222 ,4220 ,4218 ,4215 ,4214 ,4211 ,4210 ,4207 ,4206 ,4204 ,4202 ,4200 ,4197 ,4197 ,4193 ,4193 ,4191 ,4188 ,4189 ,4188 ,4185 ,4183 ,4182 ,4181 ,4178 ,4179 ,4177 ,4177 ,4176 ,4173 ,4173 ,4172 ,4170 ,4170 ,4168 ,4166 ,4163 ,4162 ,4161 ,4161 ,4159 ,4157 ,4156 ,4156 ,4154 ,4154 ,4153 ,4150 ,4150 ,4149 ,4150 ,4148 ,4146 ,4145 ,4144 ,4143 ,4142 ,4142 ,4142 ,4141 ,4142 ,4140 ,4140 ,4137 ,4136 ,4135 ,4135 ,4132 ,4133 ,4132 ,4132 ,4130 ,4129 ,4129 ,4128 ,4126 ,4125 ,4124 ,4124 ,4123 ,4123 ,4122 ,4121 ,4121 ,4118 ,4117 ,4116 ,4115 ,4115 ,4113 ,4113 ,4112 ,4112 ,4110 ,4110 ,4109 ,4106 ,4106 ,4104 ,4105 ,4103 ,4101 ,4101 ,4098 ,4098 ,4098 ,4096 ,4095 ,4094 ,4092 ,4092 ,4092 ,4090 ,4090 ,4089 ,4088 ,4087 ,4088 ,4086 ,4085 ,4084 ,4085 ,4083 ,4082 ,4082 ,4081 ,4081 ,4080 ,4079 ,4080 ,4079 ,4079 ,4078 ,4077 ,4077 ,4077 ,4076 ,4075 ,4075 ,4074 ,4074 ,4073 ,4073 ,4073 ,4070 ,4071 ,4072 ,4070 ,4070 ,4070 ,4069 ,4069 ,4070 ,4068 ,4069 ,4067 ,4067 ,4067 ,4067 ,4067 ,4067 ,4067 ,4066 ,4065 ,4065 ,4065 ,4065 ,4064 ,4064 ,4064 ,4064 ,4064 ,4065 ,4065 ,4064 ,4064 ,4065 ,4064 ,4064 ,4064 ,4063 ,4064 ,4062 ,4062 ,4062 ,4060 ,4062 ,4062 ,4061 ,4060 ,4060 ,4059 ,4060 ,4059 ,4058 ,4058 ,4058 ,4056 ,4056 ,4055 ,4056 ,4058 ,4054 ,4056 ,4055 ,4054 ,4054 ,4054 ,4053 ,4053 ,4053 ,4054 ,4053 ,4054 ,4053 ,4053 ,4055 ,4052 ,4053 ,4053 ,4053 ,4053 ,4051 ,4050 ,4050 ,4051 ,4051 ,4051 ,4051 ,4049 ,4050 ,4049 ,4050 ,4048 ,4048 ,4047 ,4047 ,4047 ,4047 ,4047 ,4046 ,4046 ,4046 ,4046 ,4047 ,4047 ,4047 ,4045 ,4045 ,4045 ,4045 ,4045 ,4045 ,4045 ,4045 ,4046 ,4046 ,4044 ,4044 ,4045 ,4043 ,4044 ,4044 ,4043 ,4041 ,4041 ,4039 ,4040 ,4042 ,4040 ,4041 ,4039 ,4039 ,4038 ,4037 ,4037 ,4036 ,4037 ,4037 ,4036 ,4037 ,4036 ,4036 ,4036 ,4034 ,4034 ,4033 ,4034 ,4033 ,4034 ,4034 ,4035 ,4035 ,4033 ,4034 ,4033 ,4033 ,4033 ,4034 ,4032 ,4034 ,4033 ,4032 ,4033 ,4034 ,4034 ,4033 ,4033 ,4034 ,4033 ,4034 ,4034 ,4035 ,4035 ,4035 ,4034 ,4034 ,4033 ,4034 ,4032 ,4034 ,4033 ,4034 ,4032 ,4033 ,4032 ,4031 ,4032 ,4030 ,4030 ,4031 ,4031 ,4030 ,4029 ,4030 ,4028 ,4029 ,4028 ,4028 ,4027 ,4026 ,4026 ,4026 ,4026 ,4026 ,4025 ,4026 ,4026 ,4024 ,4025 ,4024 ,4024 ,4025 ,4024 ,4025 ,4024 ,4024 ,4025 ,4024 ,4023 ,4024 ,4024 ,4025 ,4023 ,4024 ,4025 ,4024 ,4025 ,4024 ,4025 ,4023 ,4024 ,4023 ,4023 ,4025 ,4024 ,4024 ,4024 ,4024 ,4022 ,4022 ,4023 ,4024 ,4022 ,4021 ,4021 ,4021 ,4020 ,4020 ,4019 ,4020 ,4018 ,4018 ,4018 ,4018 ,4019 ,4019 ,4017 ,4017 ,4016 ,4016 ,4017 ,4017 ,4017 ,4017 ,4019 ,4019 ,4020 ,4021 ,4022 ,4022 ,4024 ,4024 ,4025 ,4026 ,4026 ,4027 ,4029 ,4031 ,4031 ,4032 ,4032 ,4033 ,4035 ,4037 ,4039 ,4039 ,4040 ,4040 ,4040 ,4041 ,4043 ,4044 ,4045 ,4046 ,4047 ,4047 ,4048 ,4048 ,4050 ,4049 ,4049 ,4049 ,4048 ,4049 ,4049 ,4047 ,4049 ,4047 ,4048 ,4047 ,4046 ,4045 ,4046 ,4045 ,4045 ,4043 ,4042 ,4041 ,4043 ,4042 ,4041 ,4041 ,4040 ,4040 ,4040 ,4041 ,4039 ,4038 ,4038 ,4037 ,4037 ,4038 ,4038 ,4036 ,4035 ,4035 ,4035 ,4034 ,4035 ,4033 ,4032 ,4032 ,4033 ,4033 ,4031 ,4032 ,4031 ,4031 ,4031 ,4030 ,4027 ,4027 ,4028 ,4027 ,4026 ,4025 ,4026 ,4024 ,4024 ,4024 ,4022 ,4021 ,4021 ,4020 ,4019 ,4019 ,4019 ,4020 ,4020 ,4020 ,4018 ,4018 ,4017 ,4018 ,4018 ,4016 ,4017 ,4015 ,4016 ,4014 ,4014 ,4014 ,4012 ,4012 ,4012 ,4013 ,4010 ,4011 ,4011 ,4009 ,4010 ,4010 ,4009 ,4010 ,4008 ,4009 ,4008 ,4009 ,4009 ,4008 ,4009 ,4008 ,4009 ,4008 ,4008 ,4009 ,4009 ,4008 ,4007 ,4007 ,4007 ,4006 ,4005 ,4006 ,4005 ,4003 ,4004 ,4003 ,4002 ,4002 ,4003 ,4002 ,4002 ,4002 ,4002 ,4002 ,4003 ,4002 ,4003 ,4003 ,4003 ,4001 ,4001 ,4001 ,4002 ,4001 ,4000 ,4001 ,4001 ,4000 ,4000 ,4001 ,4001 ,4001 ,3999 ,4002 ,4001 ,4001 ,4001 ,3999 ,3999 ,4001 ,3999 ,3999 ,3998 ,3997 ,3997 ,3997 ,3996 ,3996 ,3996 ,3997 ,3998 ,3996 ,3997 ,3995 ,3995 ,3995 ,3995 ,3995 ,3995 ,3993 ,3994 ,3993 ,3994 ,3992 ,3992 ,3992 ,3992 ,3994 ,3992 ,3990 ,3991 ,3990 ,3990 ,3990 ,3991 ,3989 ,3988 ,3987 ,3988 ,3988 ,3987 ,3985 ,3986 ,3985 ,3985 ,3985 ,3984 ,3985 ,3984 ,3986 ,3983 ,3983 ,3984 ,3983 ,3984 ,3985 ,3984 ,3984 ,3982 ,3983 ,3983 ,3984 ,3983 ,3983 ,3984 ,3984 ,3983 ,3984 ,3984 ,3984 ,3985 ,3984 ,3985 ,3985 ,3986 ,3985 ,3987 ,3986 ,3988 ,3987 ,3986 ,3987 ,3988 ,3987 ,3987 ,3987 ,3987 ,3987 ,3986 ,3985 ,3985 ,3985 ,3985 ,3986 ,3985 ,3987 ,3987 ,3986 ,3986 ,3986 ,3986 ,3985 ,3985 ,3985 ,3983 ,3986 ,3986 ,3984 ,3985 ,3985 ,3985 ,3983 ,3985 ,3984 ,3983 ,3984 ,3984 ,3982 ,3982 ,3982 ,3982 ,3981 ,3981 ,3981 ,3982 ,3981 ,3980 ,3979 ,3979 ,3979 ,3979 ,3978 ,3978 ,3979 ,3979 ,3979 ,3979 ,3979 ,3979 ,3979 ,3979 ,3981 ,3979 ,3980 ,3980 ,3980 ,3981 ,3982 ,3982 ,3982 ,3982 ,3982 ,3982 ,3981 ,3982 ,3981 ,3982 ,3982 ,3981 ,3983 ,3983 ,3982 ,3982 ,3984 ,3983 ,3983 ,3984 ,3984 ,3984 ,3983 ,3983 ,3984 ,3984 ,3984 ,3982 ,3982 ,3981 ,3983 ,3983 ,3981 ,3980 ,3980 ,3980 ,3979 ,3980 ,3979 ,3979 ,3977 ,3978 ,3976 ,3975 ,3975 ,3975 ,3974 ,3974 ,3973 ,3973 ,3973 ,3973 ,3973 ,3973 ,3972 ,3972 ,3971 ,3972 ,3970 ,3971 ,3971 ,3970 ,3969 ,3969 ,3969 ,3969 ,3970 ,3969 ,3969 ,3968 ,3968 ,3969 ,3970 ,3969 ,3971 ,3971 ,3971 ,3971 ,3971 ,3972 ,3971 ,3971 ,3972 ,3972 ,3971 ,3970 ,3970 ,3969 ,3968 ,3970 ,3969 ,3969 ,3970 ,3968 ,3969 ,3969 ,3967 ,3967 ,3968 ,3968 ,3966 ,3966 ,3966 ,3966 ,3965 ,3965 ,3965 ,3964 ,3964 ,3966 ,3964 ,3964 ,3964 ,3963 ,3963 ,3963 ,3962 ,3963 ,3961 ,3962 ,3961 ,3962 ,3961 ,3962 ,3962 ,3960 ,3960 ,3961 ,3962 ,3962 ,3961 ,3963 ,3964 ,3963 ,3963 ,3963 ,3963 ,3964 ,3963 ,3963 ,3963 ,3964 ,3963 ,3962 ,3962 ,3962 ,3963 ,3962 ,3963 ,3963 ,3963 ,3962 ,3962 ,3962 ,3961 ,3961 ,3960 ,3960 ,3961 ,3960 ,3960 ,3959 ,3960 ,3960 ,3958 ,3956 ,3957 ,3959 ,3959 ,3958 ,3958 ,3959 ,3958 ,3959 ,3959 ,3958 ,3958 ,3958 ,3957 ,3958 ,3958 ,3958 ,3958 ,3957 ,3960 ,3958 ,3958 ,3959 ,3958 ,3959 ,3958 ,3958 ,3959 ,3959 ,3960 ,3959 ,3959 ,3958 ,3958 ,3959 ,3960 ,3958 ,3960 ,3961 ,3961 ,3961 ,3962 ,3961 ,3962 ,3962 ,3964 ,3963 ,3962 ,3961 ,3962 ,3962 ,3961 ,3962 ,3962 ,3961 ,3962 ,3962 ,3962 ,3960 ,3959 ,3958 ,3959 ,3961 ,3961 ,3960 ,3960 ,3960 ,3960 ,3959 ,3959 ,3960 ,3960 ,3961 ,3961 ,3961 ,3962 ,3962 ,3963 ,3963 ,3963 ,3963 ,3963 ,3963 ,3963 ,3962 ,3963 ,3962 ,3961 ,3961 ,3962 ,3960 ,3961 ,3960 ,3959 ,3961 ,3960 ,3959 ,3959 ,3958 ,3958 ,3956 ,3957 ,3958 ,3956 ,3956 ,3957 ,3958 ,3956 ,3956 ,3957 ,3956 ,3955 ,3956 ,3955 ,3955 ,3955 ,3954 ,3955 ,3955 ,3955 ,3955 ,3955 ,3956 ,3956 ,3956 ,3956 ,3957 ,3957 ,3957 ,3957 ,3957 ,3957 ,3956 ,3956 ,3957 ,3956 ,3956 ,3956 ,3955 ,3956 ,3954 ,3954 ,3955 ,3955 ,3955 ,3954 ,3954 ,3954 ,3953 ,3953 ,3953 ,3955 ,3956 ,3954 ,3952 ,3951 ,3951 ,3953 ,3953 ,3952 ,3951 ,3952 ,3951 ,3951 ,3952 ,3951 ,3952 ,3950 ,3950 ,3951 ,3951 ,3949 ,3950 ,3950 ,3950 ,3949 ,3951 ,3949 ,3949 ,3948 ,3948 ,3948 ,3948 ,3948 ,3948 ,3949 ,3948 ,3946 ,3947 ,3947 ,3946 ,3946 ,3946 ,3945 ,3946 ,3946 ,3947 ,3946 ,3946 ,3947 ,3946 ,3947 ,3947 ,3946 ,3947 ,3948 ,3948 ,3946 ,3947 ,3947 ,3948 ,3949 ,3949 ,3948 ,3948 ,3948 ,3948 ,3949 ,3948 ,3948 ,3949 ,3949 ,3951 ,3950 ,3950 ,3948 ,3949 ,3949 ,3950 ,3950 ,3949 ,3949 ,3949 ,3950 ,3950 ,3950 ,3951 ,3950 ,3951 ,3950 ,3950 ,3950 ,3950 ,3950 ,3950 ,3951 ,3949 ,3948 ,3949 ,3950 ,3950 ,3950 ,3949 ,3949 ,3949 ,3950 ,3949 ,3951 ,3950 ,3951 ,3951 ,3950 ,3951 ,3949 ,3950 ,3950 ,3950 ,3951 ,3952 ,3951 ,3951 ,3951 ,3952 ,3950 ,3950 ,3950 ,3950 ,3949 ,3950 ,3950 ,3951 ,3950 ,3951 ,3950 ,3951 ,3950 ,3950 ,3951 ,3950 ,3951 ,3950 ,3951 ,3951 ,3952 ,3951 ,3951 ,3951 ,3951 ,3953 ,3953 ,3952 ,3952 ,3952 ,3951 ,3953 ,3952 ,3954 ,3951 ,3953 ,3954 ,3954 ,3954 ,3954 ,3954 ,3954 ,3954 ,3956 ,3954 ,3954 ,3954 ,3953 ,3953 ,3953 ,3953 ,3951 ,3951 ,3952 ,3950 ,3951 ,3951 ,3950 ,3951 ,3950 ,3949 ,3950 ,3950 ,3948 ,3949 ,3949 ,3949 ,3949 ,3949 ,3950 ,3947 ,3949 ,3947 ,3949 ,3947 ,3948 ,3948 ,3947 ,3947 ,3946 ,3946 ,3947 ,3948 ,3947 ,3946 ,3946 ,3946 ,3946 ,3945 ,3947 ,3947 ,3944 ,3945 ,3944 ,3944 ,3943 ,3945 ,3944 ,3944 ,3944 ,3945 ,3943 ,3944 ,3945 ,3944 ,3945 ,3945 ,3945 ,3943 ,3945 ,3945 ,3945 ,3946 ,3946 ,3947 ,3947 ,3947 ,3947 ,3945 ,3947 ,3945 ,3946 ,3946 ,3946 ,3946 ,3945 ,3945 ,3945 ,3946 ,3945 ,3946 ,3946 ,3946 ,3946 ,3946 ,3945 ,3946])
x_data = np.arange(len(y_data))

xdata=x_data[(x_data<500)|(x_data>1000)]
ydata=y_data[(x_data<500)|(x_data>1000)]

popt, pcov = curve_fit(model_f, xdata, ydata)
p=y_data[100:200]
plt.plot(x_data, model_f(x_data,popt[0], popt[1]), 'r-', label='Fitted Curve')
peaks, _ = find_peaks(p)
peaks+=100
print(peaks)
result=list(map(lambda a:y_data[a],peaks))
max_value = max(result)
i=0
for y in result:
    i+=1
    if max_value==y:
        break
print(*popt)
print(peaks[i],max_value)

ratio=max_value/model_f(peaks[i],*popt)
print("the ratio is",ratio)

#print(popt)
plt.plot(x_data, y_data, 'ko', label='Original Data')
#plt.plot(x_data, peak, label='peak')


plt.show()
